- SCORE-BASED GENERATIVE MODELING THROUGH STOCHASTIC DIFFERENTIAL EQUATIONSの論文についてdeep researchでまとめ、生成したドキュメント

# スコアベース生成モデルの基本的な仕組み  
スコアベース生成モデル（Score-Based Generative Model）は、データ分布の**スコア関数**（対数確率密度の勾配）を学習し、それを利用して新たなデータを生成する手法です ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=SGM%E3%81%A8%E3%81%AF%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%A7%E3%81%99%E3%80%82%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%81%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E5%88%86%E5%B8%83%E3%81%AE%E5%AF%BE%E6%95%B0%E3%81%AE%E5%8B%BE%E9%85%8D%E3%82%92%E8%A1%A8%E3%81%97%E3%80%81%E7%89%B9%E5%AE%9A%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%83%87%E3%83%BC%20%E3%82%BF%E5%88%86%E5%B8%83%E3%81%AE%E6%9C%80%E3%82%82%E5%A4%A7%E3%81%8D%E3%81%AA%E5%A4%89%E5%8C%96%E3%81%AE%E6%96%B9%E5%90%91%E3%82%92%E7%A4%BA%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E4%B8%AD%E3%80%81SGM%20%E3%81%AF%E3%82%AC%E3%82%A6%E3%82%B9%E3%83%8E%E3%82%A4%E3%82%BA%E3%81%AE%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E5%A2%97%E5%8A%A0%E3%81%95%E3%81%9B%E3%81%A6%E5%85%A5%E5%8A%9B%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E6%92%B9%E4%B9%B1%E3%81%97%E3%80%81%E3%83%8E%E3%82%A4%E3%82%BA%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%20,%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%80%81%E3%81%99%E3%81%B9%E3%81%A6%E3%81%AE%E3%83%8E%E3%82%A4%E3%82%BA%E3%81%AE%E3%81%82%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E5%88%86%E5%B8%83%E3%81%AE%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E6%8E%A8%E5%AE%9A%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20SGM%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%A7%E3%81%AF%E3%80%81%E3%83%8E%E3%82%A4%E3%82%BA%20%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E6%B8%9B%E5%B0%91%E3%81%95%E3%81%9B%E3%81%AA%E3%81%8C%E3%82%89%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E9%80%A3%E9%8E%96%E3%81%95%E3%81%9B%E3%80%81%E7%A2%BA%E7%8E%87%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%AA%E3%81%A9%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E6%89%8B%E6%B3%95%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%96%B0%E3%81%97%E3%81%84%E3%83%87%E3%83%BC%E3%82%BF%20%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E7%94%9F%E6%88%90%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20SGM%E3%81%A7%E3%81%AE%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%A8%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E5%88%86%E9%9B%A2%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%8B%E3%83%BC%E3%82%BA%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%84%E3%81%A6%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0))。具体的には、まず**順方向**にデータに徐々にノイズを加えていく過程を考えます（例えば画像にランダムノイズを少しずつ加えて最終的に真っ白なノイズ画像に壊していくイメージです）。この過程は確率微分方程式（**SDE**）によって連続時間で表現でき、時間とともにデータ分布をガウス分布（純粋なノイズ）へと連続的に変換していきます ([ Score-Based Diffusion Models | Fan Pu Zeng ](https://fanpu.io/blog/2023/score-based-diffusion-models/#:~:text=We%20want%20our%20diffusion%20process,given%20by%20the%20following%20process)) ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=))。次に、この逆方向（ノイズからデータへの復元）を行うために、各ノイズレベルにおけるデータ分布のスコア（どの方向にデータが濃密になるかの勾配）を推定する**ノイズ条件付きスコアネットワーク**を訓練します ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=SGM%E3%81%A8%E3%81%AF%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%A7%E3%81%99%E3%80%82%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%81%8C%E3%83%87%E3%83%BC%E3%82%BF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E5%88%86%E5%B8%83%E3%81%AE%E5%AF%BE%E6%95%B0%E3%81%AE%E5%8B%BE%E9%85%8D%E3%82%92%E8%A1%A8%E3%81%97%E3%80%81%E7%89%B9%E5%AE%9A%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%83%87%E3%83%BC%20%E3%82%BF%E5%88%86%E5%B8%83%E3%81%AE%E6%9C%80%E3%82%82%E5%A4%A7%E3%81%8D%E3%81%AA%E5%A4%89%E5%8C%96%E3%81%AE%E6%96%B9%E5%90%91%E3%82%92%E7%A4%BA%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E4%B8%AD%E3%80%81SGM%20%E3%81%AF%E3%82%AC%E3%82%A6%E3%82%B9%E3%83%8E%E3%82%A4%E3%82%BA%E3%81%AE%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E5%A2%97%E5%8A%A0%E3%81%95%E3%81%9B%E3%81%A6%E5%85%A5%E5%8A%9B%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E6%92%B9%E4%B9%B1%E3%81%97%E3%80%81%E3%83%8E%E3%82%A4%E3%82%BA%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%20,%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%80%81%E3%81%99%E3%81%B9%E3%81%A6%E3%81%AE%E3%83%8E%E3%82%A4%E3%82%BA%E3%81%AE%E3%81%82%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E5%88%86%E5%B8%83%E3%81%AE%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E6%8E%A8%E5%AE%9A%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20SGM%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%A7%E3%81%AF%E3%80%81%E3%83%8E%E3%82%A4%E3%82%BA%20%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E6%B8%9B%E5%B0%91%E3%81%95%E3%81%9B%E3%81%AA%E3%81%8C%E3%82%89%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E9%80%A3%E9%8E%96%E3%81%95%E3%81%9B%E3%80%81%E7%A2%BA%E7%8E%87%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%AA%E3%81%A9%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E6%89%8B%E6%B3%95%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%96%B0%E3%81%97%E3%81%84%E3%83%87%E3%83%BC%E3%82%BF%20%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E7%94%9F%E6%88%90%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20SGM%E3%81%A7%E3%81%AE%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%A8%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E5%88%86%E9%9B%A2%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%8B%E3%83%BC%E3%82%BA%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%84%E3%81%A6%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0))。このネットワークは入力データに様々な強さのガウスノイズを加えたものを使って訓練され、ノイズが加わったデータから元のデータ分布の勾配（スコア）を予測できるようになります。訓練には**スコアマッチング**（特に**ノイズ除去スコアマッチング**）という手法を用い、モデルが真のスコア関数に一致するようにパラメータを最適化します。例えば時刻$t$における目標のスコア $\nabla_{x}\log p_t(x)$ とモデルの予測するスコア $s_\theta(x,t)$との二乗誤差を重み付けして最小化します ([ Score-Based Diffusion Models | Fan Pu Zeng ](https://fanpu.io/blog/2023/score-based-diffusion-models/#:~:text=The%20objective%20function%20for%20score,SDE%20is%20then%20given%20by))。  

このようにして得られたスコアネットワークを用い、**逆方向の拡散過程（逆SDE）**を数値的に解くことでサンプリング（新規データ生成）を行います ([ Score-Based Diffusion Models | Fan Pu Zeng ](https://fanpu.io/blog/2023/score-based-diffusion-models/#:~:text=%5C%5B%5Cbegin,align))。逆SDEの式には先ほど学習した時間依存のスコア関数$\nabla_x \log p_t(x)$が登場し、これがノイズを除去する方向を示す役割を果たします ([ Score-Based Diffusion Models | Fan Pu Zeng ](https://fanpu.io/blog/2023/score-based-diffusion-models/#:~:text=%5C%5B%5Cbegin,align))。直感的には、「現在のデータが属する分布のどの方向に“濃い”データがあるか」を示すベクトル場（スコア）に従って、ノイズを一歩ずつ取り除いていくプロセスです。具体的な生成手順としては、まずガウスノイズから出発し、時間を徐々に巻き戻しながら小さなステップごとにノイズを減らすようデータを更新していきます（各ステップでスコアネットワークの出力に基づいてデータ点をわずかに修正します）。この**反復的なノイズ除去**のプロセスにより、最終的に元のデータ分布からのサンプルが得られます ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=SGM%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%A7%E3%81%AF%E3%80%81%E3%83%8E%E3%82%A4%E3%82%BA%20%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E6%B8%9B%E5%B0%91%E3%81%95%E3%81%9B%E3%81%AA%E3%81%8C%E3%82%89%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E9%80%A3%E9%8E%96%E3%81%95%E3%81%9B%E3%80%81%E7%A2%BA%E7%8E%87%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%AA%E3%81%A9%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E6%89%8B%E6%B3%95%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%96%B0%E3%81%97%E3%81%84%E3%83%87%E3%83%BC%E3%82%BF%20%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E7%94%9F%E6%88%90%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20SGM%E3%81%A7%E3%81%AE%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%A8%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E5%88%86%E9%9B%A2%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%8B%E3%83%BC%E3%82%BA%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%84%E3%81%A6%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%20%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%82%92%E6%9F%94%E8%BB%9F%E3%81%AB%E9%81%B8%E6%8A%9E%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82SGM%E3%81%8CGAN%E3%81%A8%E5%90%8C%E7%AD%89%E3%81%AB%E9%AB%98%E5%93%81%E8%B3%AA%E3%81%AE%E7%94%BB%E5%83%8F%E3%82%84%E3%83%93%E3%83%87%E3%82%AA%E3%81%AE%E7%94%9F%E6%88%90%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%95%E3%82%8C%E3%80%81%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%AB%E3%82%8F%E3%81%9F%E3%82%8B%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E9%80%B2%E6%AD%A9%E3%81%AB%E8%B2%A2%E7%8C%AE%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。スコアベースモデルでは「学習（スコア推定）」と「サンプリング（スコアに従った生成）」が明確に分離されているため、サンプリング時には問題に応じて様々なアルゴリズムを柔軟に適用できる点も特徴です ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=SGM%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%A7%E3%81%AF%E3%80%81%E3%83%8E%E3%82%A4%E3%82%BA%20%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E6%B8%9B%E5%B0%91%E3%81%95%E3%81%9B%E3%81%AA%E3%81%8C%E3%82%89%E3%82%B9%E3%82%B3%E3%82%A2%E9%96%A2%E6%95%B0%E3%82%92%E9%80%A3%E9%8E%96%E3%81%95%E3%81%9B%E3%80%81%E7%A2%BA%E7%8E%87%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%BC%8F%E3%81%AA%E3%81%A9%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E6%89%8B%E6%B3%95%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E6%96%B0%E3%81%97%E3%81%84%E3%83%87%E3%83%BC%E3%82%BF%20%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E7%94%9F%E6%88%90%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20SGM%E3%81%A7%E3%81%AE%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%A8%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E5%88%86%E9%9B%A2%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%8B%E3%83%BC%E3%82%BA%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%84%E3%81%A6%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%20%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%82%92%E6%9F%94%E8%BB%9F%E3%81%AB%E9%81%B8%E6%8A%9E%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82SGM%E3%81%8CGAN%E3%81%A8%E5%90%8C%E7%AD%89%E3%81%AB%E9%AB%98%E5%93%81%E8%B3%AA%E3%81%AE%E7%94%BB%E5%83%8F%E3%82%84%E3%83%93%E3%83%87%E3%82%AA%E3%81%AE%E7%94%9F%E6%88%90%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%95%E3%82%8C%E3%80%81%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%AB%E3%82%8F%E3%81%9F%E3%82%8B%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E9%80%B2%E6%AD%A9%E3%81%AB%E8%B2%A2%E7%8C%AE%E3%81%97%E3%81%BE%E3%81%99%E3%80%82))。例えば、確率微分方程式の数値解法（Euler-Maruyama法など）や確率的なランジュバン力学に基づく手法を組み合わせてサンプル品質を高めることも可能です。  

# 拡散モデルとの比較と優位性（モチベーション）  
**拡散モデル**（diffusion model）とスコアベース生成モデルは基本原理において密接に関係しており、実は本質的に**同じモデルファミリーの別視点**だと現在では理解されています ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Collectively%2C%20these%20latest%20developments%20seem,formulations%20of%20quantum%20mechanics%20in))。拡散モデルは、データにノイズを加える**離散的なステップ**の系列と、それを逆方向に辿る学習済みのデコーダ（復元過程）によってサンプリングを行います。一方、スコアベースモデルは上記のように**連続時間**でのノイズ注入とスコア関数推定に基づき、ランジュバンダイナミクスなどでサンプリングを行います。当初は「拡散モデルは変分推論（ELBO）による訓練」、「スコアベースモデルはスコアマッチングによる訓練」と異なる枠組みに見えていましたが、2020年のHoらの研究により拡散モデルの訓練目的（ELBO）がスコアマッチング目的の重み付き和と実質的に等価であることが示され、両者の深い繋がりが明らかになりました ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=In%202020%2C%20Jonathan%20Ho%20and,comparable%20or%20superior%20to%20GANs)) ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=unveiled%20a%20deeper%20connection%20to,comparable%20or%20superior%20to%20GANs))。実際、**拡散モデルの損失関数はスコアマッチングの損失と（ほぼ）同じ**であり、拡散モデルはあるノイズスケールで訓練したスコアモデルに対応しています ([拡散モデル入門②、SDE/ODEに基づくスコアベースの生成モデル（Tensorflow実装付き） #Python - Qiita](https://qiita.com/pocokhc/items/53910208abc1b1fde5e8#:~:text=,sigma%24%20%E3%81%AE%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%A7%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%95%E3%82%8C%E3%81%9F%E3%82%B9%E3%82%B3%E3%82%A2%E3%83%A2%E3%83%87%E3%83%AB%E3%81%A8%E9%9D%9E%E5%B8%B8%E3%81%AB%E4%BC%BC%E3%81%A6%E3%81%8A%E3%82%8A%E3%80%81%E3%81%A9%E3%81%A1%E3%82%89%E3%81%AE%E3%83%A2%E3%83%87%E3%83%AB%E3%82%82%E5%8F%8D%E5%BE%A9%E7%9A%84%E3%81%A7%E3%80%81%E5%90%84%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E3%81%A7%E3%82%88%E3%82%8A%E5%A4%9A%E3%81%8F%E3%81%AE%E3%83%8E%E3%82%A4%E3%82%BA%E3%82%92%E8%80%83%E6%85%AE%E3%81%99%E3%82%8B%E3%80%82))。このような類似点に基づき、Yang Songらの「スコアベース生成モデルとSDE」の研究 ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=,SDE%20solvers%20to%20generate%20samples))では**両手法を統合するフレームワーク**が打ち立てられました。彼らは拡散モデルにおける逐次復元サンプラーとスコアベースモデルのランジュバンサンプリングを組み合わせて**「予測子-補正子（Predictor-Corrector）サンプラー」**という新たなサンプリング手法を導入し、離散だったノイズスケールを**連続無限のスケール**へ一般化することで、拡散モデルとスコアベースモデルの双方を同一のSDEの離散化とみなせることを示しました ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Inspired%20by%20their%20work%2C%20we,based%20generative%20modeling%20and)) ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=score,modeling%20into%20a%20unified%20framework))。これは両者を一つの統一的な理論枠組みに橋渡しするものであり、**拡散モデルの持つ利点**（例えば洗練された復元プロセス）と**スコアベースモデルの利点**（例えば安定したスコアマッチング訓練）を融合しています。  

この統一的アプローチにより、従来の拡散モデルにはなかったいくつかの**優れた点**が実現されています。第一に、**連続時間SDEによる柔軟性**です。時間を連続扱いすることで、ノイズ除去過程を滑らかに制御でき、ステップ数を増減したり異なる数値解法を用いたりといった調整が容易になります ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=))。例えば高品質なサンプルが欲しい場合は細かいステップで計算し、速さを優先する場合はステップを粗くする、といったトレードオフを調整できます。またSDEを用いることで**複雑な分布への適応力**が増し、データ分布をシームレスに扱えるため様々な領域の高次元データでも高品質なサンプル生成に寄与します ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=))。第二に、**予測子-補正子法によるサンプル品質の向上**です。予測子（Predictor）ステップで一旦通常の逆SDEによる更新を行い、続く補正子（Corrector）ステップでランジュバン力学により微調整することで、離散時間での近似誤差を補正しノイズ除去の精度を高めます ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=sampling%20procedures%20and%20new%20modeling,10%20with))。この手法により少ないステップでも精細な生成が可能となり、結果として画像の品質指標（FIDやInceptionスコアなど）が向上しました ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=and%20colorization,based%20generative%20model))。第三に、**確率フロー常微分方程式（Probability Flow ODE）の導出**です。これは先述のSDEと同じ分布変換を実現する**決定論的なODE**で、モデルで生成したデータの**対数尤度（真の確率密度）を積分によって正確に計算**できるという特徴があります ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=sampling%20procedures%20and%20new%20modeling,10%20with))。従来の拡散モデルでは生成分布の尤度は変分下界の推定に留まっていましたが、この確率フローODEを用いることで生成モデルとしての厳密な評価や比較が可能になりました ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=sampling%20procedures%20and%20new%20modeling,10%20with))。さらに、このODEはサンプリングの高速化にも寄与します（確率的な拡散過程を解く代わりにODE解を用いることでステップ数を減らせる可能性があります）。第四に、**汎用性・応用範囲の拡大**です。スコアベースモデルは**条件付き生成**や**逆問題の解法**にも容易に拡張できます。例えば論文では**クラス条件付きの画像生成**や、画像の欠損部分を補完する**インペインティング**、白黒画像の**自動着色**といったタスクにスコアベースモデルを応用し、観測された一部の情報から残りを高品質に生成できることを実証しています ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=likelihood%20computation%2C%20and%20improved%20sampling,based%20generative%20model))。これらは従来手法でも可能ではあるものの、スコア関数さえ推定できれば同じ枠組みで実現できる点は実用上大きな強みです。最後に、これらの改良により**生成性能自体の大幅な向上**が報告されています。実際、Yang Songらのモデルは無条件の画像生成において当時最高水準の性能（例えばCIFAR-10でInception Score 9.89・FID 2.20という記録）を達成し、スコアベースモデルとして初めて$1024\times1024$解像度の高精細画像生成に成功しています ([[2011.13456] Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456#:~:text=and%20colorization,based%20generative%20model))。これはGANなど他のモデルよりも優れた品質であり、拡散モデル系アプローチの有効性を示す画期的な結果となりました。  

# スコアベース生成モデルの応用例  
このようなスコアベース／拡散型の生成モデルは、近年非常に広範な分野で応用されています。**画像生成**はその代表例で、モデルが学習したデータ分布から写真やイラストを新規に作り出すことが可能です。高解像度の人や風景の画像生成、アニメ風のイラスト生成など、従来のGANでは難しかった高品質・高多様性な画像生成を実現しています ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Score,CT%2C%20MRI%29))。特に文章から画像を生成するテキスト対画像モデル（例：OpenAIの「DALL-E 2」やStable Diffusion、MidJourneyなど）は、この技術に基づいて驚くほど多彩な画像を生成できるため広く注目を集めています ([Speeding up drug discovery with diffusion generative models | MIT News | Massachusetts Institute of Technology](https://news.mit.edu/2023/speeding-drug-discovery-with-diffusion-generative-models-diffdock-0331#:~:text=With%20the%20release%20of%20platforms,likelihood%20of%20adverse%20side%20effects))。また画像分野では、**画像の編集・復元**への応用も盛んです。例えば前述のインペインティング（欠損箇所の復元）やカラー化、超解像など、与えられた不完全な画像から高品質な画像を復元・生成するタスクにおいて、スコアベースモデルは最先端の結果を出しています ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=flow%20models%20blog,CT%2C%20MRI%29))。  

**音声・音楽生成**の分野でも応用が進んでいます。スコアベースモデルを用いることで、人の音声や楽器演奏といった**オーディオ信号の生成**や変換が可能です ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Score,CT%2C%20MRI%29))。例えばテキストから自然な音声を合成するテキスト読み上げ（TTS）や、ピアノ曲など音楽フレーズの生成では、従来の手法に比べクリアで高忠実度なサウンドを得られる手法が提案されています。また、音声のノイズ除去や変換（ある話者の声を別人の声質に変えるなど）にも応用研究が進んでいます。さらに**3次元データの生成**にもこの技術が使われます ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Score,connections%20to%20%2019%20normalizing))。ポイントクラウド（点群）や3Dメッシュの生成、あるいは3D形状の復元では、スコアベースモデルによって複雑な3D形状分布から多様なサンプルを生成できることが示されています ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Score,CT%2C%20MRI%29))。例えば新しいデザインの家具やキャラクターモデルの形状を生成したり、断片的な3Dスキャンから元の形を補完するといった応用が考えられます。  

**科学・工学分野**への応用も注目されています。医療画像などの**医学分野**では、低線量のCT画像や不完全なMRIスキャンから高品質な画像を再構成する課題にスコアベース生成モデルが利用されています ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=facilitates%20inverse%20problem%20solving%2C%20with,CT%2C%20MRI%29))。これは患者への負担を減らしつつ画像品質を向上させる応用例で、実際にMRI再構成にこのモデルを用いた研究が報告されています。また、**創薬・分子設計**の領域では、拡散モデルの原理を応用して新しい分子構造を生成したり、タンパク質と薬剤分子の結合（ドッキング）パターンを予測したりする試みがあります。MITの研究チームは「DiffDock」というモデルを開発し、拡散モデルを用いて分子ドッキング（薬剤分子が標的タンパク質に結合する位置と姿勢の予測）の問題に取り組んでいます ([Speeding up drug discovery with diffusion generative models | MIT News | Massachusetts Institute of Technology](https://news.mit.edu/2023/speeding-drug-discovery-with-diffusion-generative-models-diffdock-0331#:~:text=With%20the%20release%20of%20platforms,likelihood%20of%20adverse%20side%20effects))。このような生成モデルを用いることで、新薬候補の探索を高速化し副作用リスクを低減できる可能性が示されています ([Speeding up drug discovery with diffusion generative models | MIT News | Massachusetts Institute of Technology](https://news.mit.edu/2023/speeding-drug-discovery-with-diffusion-generative-models-diffdock-0331#:~:text=With%20the%20release%20of%20platforms,likelihood%20of%20adverse%20side%20effects))。さらに、**物理学や金融工学**といった分野にも応用が広がりつつあります。例えば量子物理における複雑な確率分布のサンプル生成や、金融データのシミュレーションにスコアベースモデルを適用しようという動きもあります ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=%E3%82%B9%E3%82%B3%E3%82%A2SDE%E3%81%8C%E3%83%8E%E3%82%A4%E3%82%BA%E9%99%A4%E5%8E%BB%E6%8B%A1%E6%95%A3%E7%A2%BA%E7%8E%87%E3%83%A2%E3%83%87%E3%83%AB%20,%E3%81%A8%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81%E9%87%8F%E5%AD%90%E7%89%A9%E7%90%86%E5%AD%A6%E3%80%81%E8%B2%A1%E5%8B%99%E5%88%86%E6%9E%90%E3%80%81%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AA%E3%81%A9%E3%81%AE%E6%A7%98%E3%80%85%E3%81%AA%E9%A0%98%E5%9F%9F%E3%81%A7%E9%AB%98%E5%93%81%E8%B3%AA%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AB%E5%84%AA%E3%82%8C%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))。これらはまだ研究段階のものも多いですが、スコアベース生成モデルの汎用性の高さから**「データさえあれば何でも生成できる」**モデルとして様々なドメインで試行されています ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=%E3%82%B9%E3%82%B3%E3%82%A2SDE%E3%81%8C%E3%83%8E%E3%82%A4%E3%82%BA%E9%99%A4%E5%8E%BB%E6%8B%A1%E6%95%A3%E7%A2%BA%E7%8E%87%E3%83%A2%E3%83%87%E3%83%AB%20,%E3%81%A8%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81%E9%87%8F%E5%AD%90%E7%89%A9%E7%90%86%E5%AD%A6%E3%80%81%E8%B2%A1%E5%8B%99%E5%88%86%E6%9E%90%E3%80%81%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AA%E3%81%A9%E3%81%AE%E6%A7%98%E3%80%85%E3%81%AA%E9%A0%98%E5%9F%9F%E3%81%A7%E9%AB%98%E5%93%81%E8%B3%AA%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AB%E5%84%AA%E3%82%8C%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82))。  

# 最新の研究動向と産業応用  
スコアベース生成モデル（拡散モデル）は、2021年頃から現在にかけて飛躍的な発展を遂げ、研究と産業の両面で大きなインパクトを与えています。研究面では、モデルの**性能向上と高速化**が主なトピックです。例えば、2022年以降のテキスト画像生成モデル（Stable DiffusionやGoogleのImagenなど）では、**潜在空間**で拡散モデルを動作させることで高解像度画像を高速に生成する工夫がなされています。拡散過程を画像そのものではなく圧縮表現（潜在ベクトル）上で行うことで計算コストを削減し、従来数百ステップ必要だった生成を数十ステップ程度で実現しています。また、**サンプリング手順の高速化**も盛んに研究されています。OpenAIの提案した**Consistency Model**は、拡散モデルの複数ステップの復元過程を学習し**1ステップでサンプルを生成**できる可能性を示しました ([OpenAI's Consistency Models Support Fast One-Step Generation for ...](https://syncedreview.com/2023/03/08/openais-consistency-models-support-fast-one-step-generation-for-diffusion-models/#:~:text=OpenAI%27s%20Consistency%20Models%20Support%20Fast,step%20generation))。これは従来の拡散モデルに比べ桁違いに高速な生成を実現する試みであり、今後このような高速サンプリング技術が実用化されればリアルタイム応用も視野に入ります。さらに、拡散モデルの**発展型**として、条件付き生成の精度向上や人間のフィードバックを取り入れたモデル最適化（例：好みの画像を生成するためのガイダンス手法）なども研究されています。  

産業応用の面では、拡散モデルは**生成AI**の代表格として様々なサービスやプロダクトに組み込まれ始めています。特に画像分野ではその傾向が顕著で、クリエイティブ業界へのインパクトは非常に大きいです。前述の**Stable Diffusion**や**MidJourney**、**DALL-E 2**といったモデルは、プロのデザイナーやアーティストから一般ユーザまで幅広く利用され、プロンプト（テキスト指示）から画像を得る新しい制作ワークフローを生み出しました ([Speeding up drug discovery with diffusion generative models | MIT News | Massachusetts Institute of Technology](https://news.mit.edu/2023/speeding-drug-discovery-with-diffusion-generative-models-diffdock-0331#:~:text=With%20the%20release%20of%20platforms,likelihood%20of%20adverse%20side%20effects))。これらは商業利用も進んでおり、ストックイラスト生成、広告デザイン、自動画像補完などに活用されています。また**動画分野**でも、静止画の拡散モデルを応用したビデオ生成（数秒程度の映像をプロンプトから作る）や既存動画の様式変換といった技術が登場しつつあり、将来的に映像制作を効率化するツールとして期待されています。**音楽分野**では、拡散モデルを用いた簡易なBGM自動生成サービスや効果音生成ツールが実験的に提供され始めています。加えて、**医療・製薬**業界もこの技術に注目しています。創薬におけるDiffDockのような研究 ([Speeding up drug discovery with diffusion generative models | MIT News | Massachusetts Institute of Technology](https://news.mit.edu/2023/speeding-drug-discovery-with-diffusion-generative-models-diffdock-0331#:~:text=With%20the%20release%20of%20platforms,likelihood%20of%20adverse%20side%20effects))を経て、医薬品候補の提案や分子構造最適化への実用化を目指す動きがあります。画像診断の領域でも、患者データからのデータ拡張やシミュレーション（例えば希少疾患の症例画像を拡散モデルで生成して診断モデルの学習データを増やすなど）への応用が模索されています。さらに、近年の生成AIブームの中で**大規模言語モデル（LLM）**と組み合わせたマルチモーダルAIにも拡散モデルは組み込まれています。例えば画像と文章の相互生成や、ユーザ対話に応じて画像を生成するシステムなど、複数のAI技術を統合した応用も登場しています。  

このように、スコアベース生成モデル（拡散モデル）は基本的な理論提案から数年で急速に発展し、研究最前線と産業応用の双方で非常に活発な領域となっています。今後も**生成品質の向上**や**高速化・低計算コスト化**、さらには**新たな分野への展開**が進むと期待されており、画像・音声から科学・医療まで幅広い分野でその技術革新が続くでしょう。スコアベース生成モデルは「ノイズからデータを作り出す」という斬新なアプローチであり、現在の生成AI革命を支える中核技術の一つとなっています ([VMO Japan | ニュース - 拡散モデル：概念と活用例の全般ガイド](https://vmogroup.jp/news/diffusion-model#:~:text=MidJourney%E3%82%84Stable%20Diffusion%E3%81%AA%E3%81%A9%E3%81%AE%E6%9C%80%E6%96%B0%E6%8A%80%E8%A1%93%E3%82%92%E3%83%93%E3%82%B8%E3%83%8D%E3%82%B9%E3%82%84%E5%80%8B%E4%BA%BA%E3%81%AE%E6%A5%AD%E5%8B%99%E3%81%A7%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%81%93%E3%81%A8%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%81%8B%EF%BC%9F%E6%8B%A1%E6%95%A3%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AF%E7%A2%BA%E3%81%8B%E3%81%AB%E6%97%A5%E5%B8%B8%E7%94%9F%E6%B4%BB%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E5%BF%9C%E7%94%A8%20%E3%81%A7%E4%BA%BA%E6%B0%97%E3%82%92%E9%9B%86%E3%82%81%E3%81%A6%E3%81%84%E3%82%8B%E5%BC%B7%E5%8A%9B%E3%81%AA%E7%94%9F%E6%88%90%E3%83%A2%E3%83%87%E3%83%AB%E3%81%A7%E3%81%99%E3%80%82%E3%81%93%E3%81%AE%E5%8C%85%E6%8B%AC%E7%9A%84%E3%81%AA%E8%A8%98%E4%BA%8B%E3%81%A7%E3%81%AF%E3%80%81%20VMO%20Japan%E3%81%A8%E4%B8%80%E7%B7%92%E3%81%AB%E3%81%8C%E6%8B%A1%E6%95%A3%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E5%9F%BA%E7%A4%8E%E3%81%A8%E3%81%AA%E3%82%8B%E6%A6%82%E5%BF%B5%E3%82%92%E6%B7%B1%E3%81%8F%E7%90%86%E8%A7%A3%E3%81%97%E3%80%81%E6%A5%AD%E7%95%8C%E5%85%A8%E4%BD%93%E3%81%A7%E3%81%AE%E5%AE%9F%E8%B7%B5%E7%9A%84%E3%81%AA%E6%B4%BB%E7%94%A8%E4%BE%8B%E3%82%92%E5%AD%A6%E3%81%B3%E3%81%BE%E3%81%97%E3%82%87%E3%81%86%E3%80%82))。各種ブログや解説記事でもこの技術の原理や実装法が詳しく紹介されており、例えばYang Song氏自身のブログではスコアベースモデルの直感的な解説とともに画像や音声での画期的な成果が示されています ([Generative Modeling by Estimating Gradients of the Data Distribution | Yang Song](https://yang-song.net/blog/2021/score/#:~:text=Score,CT%2C%20MRI%29))。産業界でもこの技術への期待は高く、創造的コンテンツ生成から専門分野の問題解決まで、スコアベース生成モデルは今後ますます存在感を増していくと考えられます。